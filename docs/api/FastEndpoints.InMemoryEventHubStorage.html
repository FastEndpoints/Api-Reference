<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Class InMemoryEventHubStorage
 | FastEndpoints </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Class InMemoryEventHubStorage
 | FastEndpoints ">
    <meta name="generator" content="docfx ">
  <meta name="description" content="A light-weight REST Api framework for ASP.Net 6 that implements REPR (Request-Endpoint-Response) Pattern">
    <link rel="shortcut icon" href="../images/favicon-32x32.ico">
    <link rel="stylesheet" href="../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/main.css">
    <meta property="docfx:navrel" content="../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
  
  <meta property="docfx:rel" content="../">
  <meta property="docfx:newtab" content="true">
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>

        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>

              <a class="navbar-brand" href="../index.html">
                <img id="logo" class="svg" src="../images/logo.png" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>

        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">

        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first="First" data-prev="Previous" data-next="Next" data-last="Last"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">

        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="FastEndpoints.InMemoryEventHubStorage">



  <h1 id="FastEndpoints_InMemoryEventHubStorage" data-uid="FastEndpoints.InMemoryEventHubStorage" class="text-break">Class InMemoryEventHubStorage
</h1>
  <div class="markdown level0 summary"></div>
  <div class="markdown level0 conceptual"></div>
  <div class="inheritance">
    <h5>Inheritance</h5>
    <div class="level0"><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object">object</a></div>
    <div class="level1"><span class="xref">InMemoryEventHubStorage</span></div>
  </div>
  <div class="implements">
    <h5>Implements</h5>
    <div><a class="xref" href="FastEndpoints.IEventHubStorageProvider-1.html">IEventHubStorageProvider</a>&lt;<a class="xref" href="FastEndpoints.InMemoryEventStorageRecord.html">InMemoryEventStorageRecord</a>&gt;</div>
  </div>
  <div class="inheritedMembers">
    <h5>Inherited Members</h5>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.equals#system-object-equals(system-object)">object.Equals(object)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.equals#system-object-equals(system-object-system-object)">object.Equals(object, object)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.gethashcode">object.GetHashCode()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.gettype">object.GetType()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.referenceequals">object.ReferenceEquals(object, object)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.tostring">object.ToString()</a>
    </div>
  </div>
  <h6><strong>Namespace</strong>: <a class="xref" href="FastEndpoints.html">FastEndpoints</a></h6>
  <h6><strong>Assembly</strong>: FastEndpoints.Messaging.Remote.dll</h6>
  <h5 id="FastEndpoints_InMemoryEventHubStorage_syntax">Syntax</h5>
  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public sealed class InMemoryEventHubStorage : IEventHubStorageProvider&lt;InMemoryEventStorageRecord&gt;</code></pre>
  </div>
  <h3 id="methods">Methods
</h3>


  <a id="FastEndpoints_InMemoryEventHubStorage_GetNextBatchAsync_" data-uid="FastEndpoints.InMemoryEventHubStorage.GetNextBatchAsync*"></a>
  <h4 id="FastEndpoints_InMemoryEventHubStorage_GetNextBatchAsync_FastEndpoints_PendingRecordSearchParams_FastEndpoints_InMemoryEventStorageRecord__" data-uid="FastEndpoints.InMemoryEventHubStorage.GetNextBatchAsync(FastEndpoints.PendingRecordSearchParams{FastEndpoints.InMemoryEventStorageRecord})">GetNextBatchAsync(PendingRecordSearchParams&lt;InMemoryEventStorageRecord&gt;)</h4>
  <div class="markdown level1 summary"><p>fetch the next batch of pending event storage records that need to be processed.</p>
</div>
  <div class="markdown level1 conceptual"></div>
  <h5 class="declaration">Declaration</h5>
  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public ValueTask&lt;IEnumerable&lt;InMemoryEventStorageRecord&gt;&gt; GetNextBatchAsync(PendingRecordSearchParams&lt;InMemoryEventStorageRecord&gt; p)</code></pre>
  </div>
  <h5 class="parameters">Parameters</h5>
  <table class="table table-bordered table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Name</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="FastEndpoints.PendingRecordSearchParams-1.html">PendingRecordSearchParams</a>&lt;<a class="xref" href="FastEndpoints.InMemoryEventStorageRecord.html">InMemoryEventStorageRecord</a>&gt;</td>
        <td><span class="parametername">p</span></td>
        <td></td>
      </tr>
    </tbody>
  </table>
  <h5 class="returns">Returns</h5>
  <table class="table table-bordered table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.threading.tasks.valuetask-1">ValueTask</a>&lt;<a class="xref" href="https://learn.microsoft.com/dotnet/api/system.collections.generic.ienumerable-1">IEnumerable</a>&lt;<a class="xref" href="FastEndpoints.InMemoryEventStorageRecord.html">InMemoryEventStorageRecord</a>&gt;&gt;</td>
        <td></td>
      </tr>
    </tbody>
  </table>


  <a id="FastEndpoints_InMemoryEventHubStorage_MarkEventAsCompleteAsync_" data-uid="FastEndpoints.InMemoryEventHubStorage.MarkEventAsCompleteAsync*"></a>
  <h4 id="FastEndpoints_InMemoryEventHubStorage_MarkEventAsCompleteAsync_FastEndpoints_InMemoryEventStorageRecord_System_Threading_CancellationToken_" data-uid="FastEndpoints.InMemoryEventHubStorage.MarkEventAsCompleteAsync(FastEndpoints.InMemoryEventStorageRecord,System.Threading.CancellationToken)">MarkEventAsCompleteAsync(InMemoryEventStorageRecord, CancellationToken)</h4>
  <div class="markdown level1 summary"><p>mark the event storage record as complete by either replacing the entity on storage with the supplied instance or
simply update the <a class="xref" href="FastEndpoints.IEventStorageRecord.html#FastEndpoints_IEventStorageRecord_IsComplete">IsComplete</a> field to true with a partial update operation.</p>
</div>
  <div class="markdown level1 conceptual"></div>
  <h5 class="declaration">Declaration</h5>
  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public ValueTask MarkEventAsCompleteAsync(InMemoryEventStorageRecord e, CancellationToken ct)</code></pre>
  </div>
  <h5 class="parameters">Parameters</h5>
  <table class="table table-bordered table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Name</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="FastEndpoints.InMemoryEventStorageRecord.html">InMemoryEventStorageRecord</a></td>
        <td><span class="parametername">e</span></td>
        <td></td>
      </tr>
      <tr>
        <td><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.threading.cancellationtoken">CancellationToken</a></td>
        <td><span class="parametername">ct</span></td>
        <td><p>cancellation token</p>
</td>
      </tr>
    </tbody>
  </table>
  <h5 class="returns">Returns</h5>
  <table class="table table-bordered table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.threading.tasks.valuetask">ValueTask</a></td>
        <td></td>
      </tr>
    </tbody>
  </table>


  <a id="FastEndpoints_InMemoryEventHubStorage_PurgeStaleRecordsAsync_" data-uid="FastEndpoints.InMemoryEventHubStorage.PurgeStaleRecordsAsync*"></a>
  <h4 id="FastEndpoints_InMemoryEventHubStorage_PurgeStaleRecordsAsync_FastEndpoints_StaleRecordSearchParams_FastEndpoints_InMemoryEventStorageRecord__" data-uid="FastEndpoints.InMemoryEventHubStorage.PurgeStaleRecordsAsync(FastEndpoints.StaleRecordSearchParams{FastEndpoints.InMemoryEventStorageRecord})">PurgeStaleRecordsAsync(StaleRecordSearchParams&lt;InMemoryEventStorageRecord&gt;)</h4>
  <div class="markdown level1 summary"><p>this method will be called hourly. implement this method to remove stale records (completed or expired) from storage.
or instead of removing them, you can move them to some other location (dead-letter-queue maybe) or for inspection by a human.
or if you'd like to retry expired events, update the <a class="xref" href="FastEndpoints.IEventStorageRecord.html#FastEndpoints_IEventStorageRecord_ExpireOn">ExpireOn</a> field to a future date/time.</p>
<p>
NOTE: the default match criteria is:
<pre><code class="lang-csharp">r =&gt; r.IsComplete || DateTime.UtcNow &gt;= r.ExpireOn</code></pre>
</div>
  <div class="markdown level1 conceptual"></div>
  <h5 class="declaration">Declaration</h5>
  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public ValueTask PurgeStaleRecordsAsync(StaleRecordSearchParams&lt;InMemoryEventStorageRecord&gt; p)</code></pre>
  </div>
  <h5 class="parameters">Parameters</h5>
  <table class="table table-bordered table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Name</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="FastEndpoints.StaleRecordSearchParams-1.html">StaleRecordSearchParams</a>&lt;<a class="xref" href="FastEndpoints.InMemoryEventStorageRecord.html">InMemoryEventStorageRecord</a>&gt;</td>
        <td><span class="parametername">p</span></td>
        <td></td>
      </tr>
    </tbody>
  </table>
  <h5 class="returns">Returns</h5>
  <table class="table table-bordered table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.threading.tasks.valuetask">ValueTask</a></td>
        <td></td>
      </tr>
    </tbody>
  </table>


  <a id="FastEndpoints_InMemoryEventHubStorage_RestoreSubscriberIDsForEventTypeAsync_" data-uid="FastEndpoints.InMemoryEventHubStorage.RestoreSubscriberIDsForEventTypeAsync*"></a>
  <h4 id="FastEndpoints_InMemoryEventHubStorage_RestoreSubscriberIDsForEventTypeAsync_FastEndpoints_SubscriberIDRestorationParams_FastEndpoints_InMemoryEventStorageRecord__" data-uid="FastEndpoints.InMemoryEventHubStorage.RestoreSubscriberIDsForEventTypeAsync(FastEndpoints.SubscriberIDRestorationParams{FastEndpoints.InMemoryEventStorageRecord})">RestoreSubscriberIDsForEventTypeAsync(SubscriberIDRestorationParams&lt;InMemoryEventStorageRecord&gt;)</h4>
  <div class="markdown level1 summary"><p>this method will only be called once (for each event type) on app startup. if there are any pending records on storage from a previous app run,
simply return a collection of unique subscriber IDs.</p>
</div>
  <div class="markdown level1 conceptual"></div>
  <h5 class="declaration">Declaration</h5>
  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public ValueTask&lt;IEnumerable&lt;string&gt;&gt; RestoreSubscriberIDsForEventTypeAsync(SubscriberIDRestorationParams&lt;InMemoryEventStorageRecord&gt; p)</code></pre>
  </div>
  <h5 class="parameters">Parameters</h5>
  <table class="table table-bordered table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Name</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="FastEndpoints.SubscriberIDRestorationParams-1.html">SubscriberIDRestorationParams</a>&lt;<a class="xref" href="FastEndpoints.InMemoryEventStorageRecord.html">InMemoryEventStorageRecord</a>&gt;</td>
        <td><span class="parametername">p</span></td>
        <td></td>
      </tr>
    </tbody>
  </table>
  <h5 class="returns">Returns</h5>
  <table class="table table-bordered table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.threading.tasks.valuetask-1">ValueTask</a>&lt;<a class="xref" href="https://learn.microsoft.com/dotnet/api/system.collections.generic.ienumerable-1">IEnumerable</a>&lt;<a class="xref" href="https://learn.microsoft.com/dotnet/api/system.string">string</a>&gt;&gt;</td>
        <td></td>
      </tr>
    </tbody>
  </table>


  <a id="FastEndpoints_InMemoryEventHubStorage_StoreEventAsync_" data-uid="FastEndpoints.InMemoryEventHubStorage.StoreEventAsync*"></a>
  <h4 id="FastEndpoints_InMemoryEventHubStorage_StoreEventAsync_FastEndpoints_InMemoryEventStorageRecord_System_Threading_CancellationToken_" data-uid="FastEndpoints.InMemoryEventHubStorage.StoreEventAsync(FastEndpoints.InMemoryEventStorageRecord,System.Threading.CancellationToken)">StoreEventAsync(InMemoryEventStorageRecord, CancellationToken)</h4>
  <div class="markdown level1 summary"><p>store the event storage record however you please. ideally on a nosql database.</p>
</div>
  <div class="markdown level1 conceptual"></div>
  <h5 class="declaration">Declaration</h5>
  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public ValueTask StoreEventAsync(InMemoryEventStorageRecord e, CancellationToken _)</code></pre>
  </div>
  <h5 class="parameters">Parameters</h5>
  <table class="table table-bordered table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Name</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="FastEndpoints.InMemoryEventStorageRecord.html">InMemoryEventStorageRecord</a></td>
        <td><span class="parametername">e</span></td>
        <td></td>
      </tr>
      <tr>
        <td><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.threading.cancellationtoken">CancellationToken</a></td>
        <td><span class="parametername">_</span></td>
        <td></td>
      </tr>
    </tbody>
  </table>
  <h5 class="returns">Returns</h5>
  <table class="table table-bordered table-condensed">
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.threading.tasks.valuetask">ValueTask</a></td>
        <td></td>
      </tr>
    </tbody>
  </table>
  <h3 id="implements">Implements</h3>
  <div>
      <a class="xref" href="FastEndpoints.IEventHubStorageProvider-1.html">IEventHubStorageProvider&lt;TStorageRecord&gt;</a>
  </div>

</article>
          </div>

          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
                <h5>In this article</h5>
                <div></div>
              </nav>
            </div>
          </div>
        </div>
      </div>

      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
      Developed by <a href='https://github.com/dj-nitehawk'>Đĵ ΝιΓΞΗΛψΚ</a> and <a href='https://github.com/dj-nitehawk/FastEndpoints/graphs/contributors'>contributors</a> / Licensed under <a href='https://github.com/dj-nitehawk/FastEndpoints/blob/master/LICENSE'>MIT</a> / Website generated by <a href='https://dotnet.github.io/docfx/'>DocFX</a>
      
          </div>
        </div>
      </footer>
    </div>

    <script type="text/javascript" src="../styles/docfx.vendor.min.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>
  </body>
</html>
